# Accessible Forms

- a form is an element that allows users to provide data
- can be as simple as a single field or as complicated as a multi-step form element with multiple fields, input validations or even CAPTCHA
- one of the most difficult elements to get right from an accessibility perspective, due to usage of many different elements with their respective rules plus form specific accessibility requirements

## Why do we need accessible forms

- for screenreader users, users that use the keyboard and everybody who likes clear instructions and a quick process

## Use native HTML

- whenever possible
- most of the native HTML form controls are accessible by default
- easier to maintain / to understand

ARIA vs. HTML

<div className="forms__comparison">
  <div className="forms__comparison--aria">
    ```html
        <div role="form" id="sundae-order-form">
           <!-- form content -->
        </div>
    ```
  </div>
   <div className="forms__comparison--html">
    ```html
        <form id="sundae-order-form">
          <!-- form content -->
        </form>
    ```
  </div>
</div>

## Forms structure

- the following question for extra bacon LOOKS exactly the same as the one with the cheese
- but navigating with the keyboard and a SR: it would only read the answers with no relation to the question

<form>
  <p>Would you like some extra bacon?</p>

   <input type="radio" id="yesBacon" name="bacon" value="yesBacon" />
   <label htmlFor="yesBacon">Yes, please!</label>
   <br></br>
   <input type="radio" id="noBacon" name="bacon" value="noBacon"/>
   <label htmlFor="noBacon">No, thanks!</label>
</form>

```html
<form>
  <p>Would you like some extra bacon?</p>

   <input type="radio" id="yesBacon" name="bacon" value="yesBacon" />
   <label htmlFor="yesBacon">Yes, please!</label>
   <br></br>
   <input type="radio" id="noBacon" name="bacon" value="noBacon"/>
   <label htmlFor="noBacon">No, thanks!</label>
</form>
```

- that is why:
- a `<form>` should contain one or multiple `<fieldset>` elements, which group several controls as well as label
- within the fieldset is the `<legend>` element to provide a caption
- this structure forms a relation between question and answer

<form action="#">
  <fieldset>
  <legend>Would you like some extra cheese?</legend>
    <input type="radio" id="yesCheese" name="cheese" value="yesCheese" />
    <label htmlFor="yesCheese">Yes, please!</label>
    <br></br>
    <input type="radio" id="noCheese" name="cheese" value="noCheese" />
    <label htmlFor="noCheese">No, thanks!</label>
  </fieldset>
</form>

```html
<form action="#">
  <fieldset>
  <legend>Would you like some extra cheese?</legend>
    <input type="radio" id="yesCheese" name="agree" />
    <label htmlFor="yesCheese">Yes, please!</label>
    <br></br>
    <input type="radio" id="noCheese" name="disagree" />
    <label htmlFor="noCheese">No, thanks!</label>
  </fieldset>
</form>
```

**Attention:** don't forget the `<form>` element, especially when using `onclick` events or similar. Whenever form controls need to be submittable, they should be placed within a `<form>` tag.

## `<label>`

- `<label>` defines label for several elements, like `<input>`, `<select>` and `<textarea>`
- screenreaders will read out loud the label when element is focused
- labels should be distinctive and descriptive

Bad:
<br></br>
<label htmlFor="txtFirstName">Name</label>
<input type="text" id="txtFirstName" />
<br></br>
Good:
<br></br>
<label htmlFor="txtFirstName">First Name</label>
<input type="text" id="txtFirstName" />

<label htmlFor="txtFirstName">Last Name</label>
<input type="text" id="txtFirstName" />


```html
<label>
  First Name
  <input type="text" />
</label>
```
```html
<label htmlFor="txtFirstName">First Name</label>
<input type="text" id="txtFirstName" />
```

### aria labels

- use only for custom form elements


## `<select>`

<form id="best-company">
  <fieldset>
  <legend>Company Survey</legend>
    <label htmlFor="bestCompany">What company is the best?</label>
    <select name="bestCompany" id="bestCompany">
      <option value="dotSource GmbH">dotSource GmbH</option>
      <option value="dotSource SE">dotSource SE</option>
      <option value="dS">dS</option>
      <option value="all of the above">all of the above</option>
    </select>
  </fieldset>
</form>

```html
<form id="best-company">
  <fieldset>
  <legend>Company Survey</legend>
    <label htmlFor="bestCompany">What company is the best?</label>
    <select name="bestCompany" id="bestCompany">
      <option value="dotSource GmbH">dotSource GmbH</option>
      <option value="dotSource SE">dotSource SE</option>
      <option value="dS">dS</option>
      <option value="all of the above">all of the above</option>
    </select>
  </fieldset>
</form>
```
## `<dialog>`

- native HTML element serves e.g. as a modal, dismissible alert or subwindow
- needs `autofocus` attribute because user is expected to interact with it immediately
- if no other element (like an input field) is implemented, `autofocus` should be on the close button or dialog itself

<dialog>
  <button className="forms__button" autoFocus>Close</button>
  <p>This modal dialog has a groovy backdrop!</p>
</dialog>
<button className="forms__button">Show the dialog</button>

```html
<dialog>
  <button className="forms__button" autoFocus>Close</button>
  <p>This modal dialog has a groovy backdrop!</p>
</dialog>
<button className="forms__button">Show the dialog</button>
```

**Attention!** Do not add tabindex property to `<dialog>` since the dialog and corresponding close button can already receive focus and be interactive

## Irritating screen reader behaviours

- in general they handle forms pretty uniformly
- some behaviours occur that may be surprising, if not confusing and some are simply buggy
- this is mainly referred to NVDA but JAWS also has some issues

### Announcing of controls' attributes

- HTML offers many attribues to customize behaviour of form controls

```html
<input type="text" />
<input type="checkbox" />
```
- NVDA announces the "edit" (for text) of "checkbox" so the user knows how to deal with the input field

#### Some attributes are non-intuitive

- plain text inputs are announced as "has autocomplete" by NVDA
- because HTML offers and autocomplete attribute for single line input; and its default is set to true
- basically shows previously typed inputs by the user
- this may be counter-intuitive because of known autosuggest feature like google has it

Test: https://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_input_autocomplete2

Solution: `autocomplete="off"` or explain what the feature does with `aria-describedby`

#### Missing announcements

- some attributes seem to not be announced at all like `maxlength` option on `<input type="text"/>`
- not even when the user's input reaches the maximum input length
- not announced by NVDA; since July 2024 available with JAWS

- `multiple` option of `<select>` element is not announced by NVDA; JAWS announces it as "multi select"

Solution: Display information inside the label for example "Full name (max. 20 character)"

### Checkboxes don't trigger focus mode

- focus mode is used when the user enters a form or other fields that require user input
- so keystrokes aren't intercepted / used for commands but to send input
- Checkboxes don't activate focus mode when navigating with the `Tab` key
- resulting in not announcing change of context when switching between `<fieldset>`'s (different topics in a form)
- because NVDA only announces the `<legend>` of a `<fieldset>` while in focus mode

Test: https://www.nvaccess.org/files/nvdaTracAttachments/3321/nvda_fieldset_announcement.html

### Disabled Buttons

- buttons are disabled for indicating, that input is invalid or incomplete
- `disable` a button is valid standard technique but confusing for screenreaders since the button is not focusable
- SR users will not recognise the end of the form

Solution: use `aria-disabled="true"` to allow the button to receive focus and announcing its disabled state

```html
<button className="forms__button" type="submit" aria-disabled="true">Disabled</button>
```

<button className="forms__button" type="submit" aria-disabled="true">Disabled</button>

## How to handle errors

## Complete form example

<form id="sundae-order-form">
  <h2>Online Sundae Order Form</h2>
  <fieldset>
    <legend>Customer Info</legend>
    <p><label>Name: <input type="name" required aria-required="true"/></label></p>
    <p><label>Telephone: <input type="tel"/></label></p>
    <p><label>Email address: <input type="email"/></label></p>
  </fieldset>

  <fieldset>
    <legend>Size</legend>
    <p><label><input type="radio" name="size" value="small"/>Small</label></p>
    <p><label><input type="radio" name="size" value="medium"/>Medium</label></p>
    <p><label><input type="radio" name="size" value="large"/>Large</label></p>
  </fieldset>

  <fieldset>
    <legend>Toppings</legend>
    <p><label><input type="checkbox" name="topping" value="whipped-cream"/>Whipped cream</label></p>
    <p><label><input type="checkbox" name="topping" value="cherry"/>Cherry</label></p>
    <p><label><input type="checkbox" name="topping" value="nuts"/>Nuts</label></p>
    <p><label><input type="checkbox" name="topping" value="caramel-sauce"/>Caramel sauce</label></p>
    <p><label><input type="checkbox" name="topping" value="chocolate-sauce"/>Chocolate sauce</label></p>
  </fieldset>
  <p><label>Delivery instructions: </label><br></br><textarea name="comments"></textarea></p>
  <p><button>Submit order</button></p>
</form>

```html
<form id="sundae-order-form">
  <h2>Online Sundae Order Form</h2>
  <fieldset>
    <legend>Customer Info</legend>
    <p><label>Name: <input type="name" required aria-required="true" /></label></p>
    <p><label>Telephone: <input type="tel"/></label></p>
    <p><label>Email address: <input type="email"/></label></p>
  </fieldset>

  <fieldset>
    <legend>Size</legend>
    <p><label><input type="radio" name="size" value="small"/>Small</label></p>
    <p><label><input type="radio" name="size" value="medium"/>Medium</label></p>
    <p><label><input type="radio" name="size" value="large"/>Large</label></p>
  </fieldset>

  <fieldset>
    <legend>Toppings</legend>
    <p><label><input type="checkbox" name="topping" value="whipped-cream"/>Whipped cream</label></p>
    <p><label><input type="checkbox" name="topping" value="cherry"/>Cherry</label></p>
    <p><label><input type="checkbox" name="topping" value="nuts"/>Nuts</label></p>
    <p><label><input type="checkbox" name="topping" value="caramel-sauce"/>Caramel sauce</label></p>
    <p><label><input type="checkbox" name="topping" value="chocolate-sauce"/>Chocolate sauce</label></p>
  </fieldset>
  <p><label>Delivery instructions: </label><br><textarea name="comments"></textarea></p>
  <p><button>Submit order</button></p>
</form>
```

## Custom form elements

- what if the native HTML elements aren't enough?
- use ARIA roles to simulate native HTML
<span data-href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles" tabIndex="0" role="link">
  Fake accessible link to a complete ARIA roles list created using a span
</span>

```html
<span data-href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles" tabIndex="0" role="link">
  Fake accessible link to a complete ARIA roles list created using a span
</span>
```

## Possible topics for future Techtalks

- custom form elements

## Sources

https://www.accessibility-developer-guide.com
https://developer.mozilla.org/en-US/docs/Web/HTML/Element
https://www.smashingmagazine.com/2023/02/guide-accessible-form-validation/
https://www.w3schools.com/accessibility/accessibility_forms_intro.php
https://web.dev/learn/accessibility/forms